<!DOCTYPE html><!--Â© Copyright 2012, 2013, 2014 Alex Jordan
This file is part of strugee.net.
strugee.net is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
strugee.net is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.	See the
GNU Affero General Public License for more details.
You should have received a copy of the GNU Affero General Public License
along with strugee.net.	If not, see <http://www.gnu.org/licenses/>.
--><!-- Made and coded by Alex Jordan--><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/bootstrap-responsive.min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><!-- IE7 support isn't really needed, but this addition is so easy I might as well --><!--[if lte IE 7]> <link rel="stylesheet" href="/css/font-awesome-ie7.min.css"> <![endif]--><link rel="stylesheet" href="/css/main.css"><!--[if gte IE 8]> <link rel="stylesheet" href="/css/ie9.css"> <![endif]--><!-- IndieWeb components, with <3--><link rel="me" href="mailto:alex@strugee.net"><link rel="me" href="sms:17607054581"><link rel="me" href="https://github.com/strugee"><link rel="me" href="https://twitter.com/strugee2"><link rel="me" href="https://plus.google.com/+AlexJordan"><link rel="me" href="https://pump.strugee.net/alex"><link rel="me" href="https://pod.strugee.net/people/82e1c9a030600133e0ca20474782d58c"><title>Work on strugee.net - strugee.net</title><link rel="pingback" href="https://webmention.io/strugee.net/xmlrpc"><link rel="webmention" href="https://webmention.io/strugee.net/webmention"></head><body><div id="container"><!--[if lt IE 7]><p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.<![endif]--><header><h1 id="topheader">strugee.net</h1><nav id="navbar"><ul><li id="navlabel" class="navlink">Nav ::</li><li class="navlink"><a href="/">Home</a></li><li class="navlink"><a href="/services">Services</a></li><li class="navlink"><a href="/projects">Projects</a></li><li class="navlink"><a href="/gpg">GPG Key</a></li><li class="navlink"><a href="http://ramblingsfromalex.blogspot.com">Blog</a></li></ul></nav></header><div id="content"><article itemscope itemtype="http://schema.org/BlogPosting" class="h-entry"><h1 class="p-name">Work on strugee.net</h1><p>Published by <a href="https://strugee.net/" rel="author" class="p-author h-card">Alex Jordan</a></p><div class="e-content"><p>I realized I forgot to blog about all the work I&#39;ve done on the <code>strugee.net</code> build code recently! I want to get back to working on Stratic part two (aka pretty indexes), but I thought I&#39;d really quickly take the time to point out what&#39;s been done.</p>
<p>First of all, even though I rewrote the code in <a href="http://jade-lang.com">Jade</a> about <a href="https://strugee.net/blog/2014/12/new-blog-new-site">a year and a half ago</a>, there was still a huge amount of boilerplate code in each Jade file. Why? Because essentially the way I did that was by running each HTML file through an <a href="http://html2jade.aaron-powell.com/">HTML to Jade</a> converter, then manually fixing up the result to be, you know, less ugly. That meant that common stuff, like the navbar, footer, includes, etc. were all duplicated across all Jade files. And that sucks, because <a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself">Don&#39;t Repeat Yourself</a> is a thing.</p>
<p>Luckily, refactoring is a thing too! So a few weeks ago, I went and split out the common site layout into <a href="https://github.com/strugee/strugee.github.com/blob/c5ec1634a6b038eec25adb5abcd2b578a60ec4fd/src/includes/layout.jade">its own Jade file</a>, then made all the individual pages inherit from that common layout. The most difficult part of this was undoubtedly the navigation bar - I was pretty sure I&#39;d have to just deal with the fact that the navbar was duplicated across pages (because each page has to have a different link deactivated), but then inspiration struck, and I ended up witht the solution I have now. Instead of treating the entire navigation as one block, I treat each <em>link</em> as a block that is overridable via Jade&#39;s <code>block</code> directive. And, since Jade <code>block</code>s can have defaults, each page only overrides exactly what it needs to, and the rest of the links are automatically there and properly clickable.</p>
<p>This has a couple nice side effects. The first is that the codebase that generates <code>strugee.net</code> is now <em>extremely</em> easy for me to change, regardless of what part of the site I touch (whereas before, individual pages were pretty easy but changing e.g. the navbar require editing each and every individual page). The second (and clearly the most important) is that Night Mode, which I implemented in a 45-minute class <em>over two years ago</em> now (back when I was still in high school - what a crazy thing to think about not being in high school anymore!) now works on every page across all of <code>strugee.net</code>. Whooo! Silly hacks are at the core of the web, right? Might as well make them work well.</p>
<p>Finally, I&#39;d be remiss if I didn&#39;t mention that I now have a proper <a href="https://github.com/strugee/strugee.github.com/blob/c5ec1634a6b038eec25adb5abcd2b578a60ec4fd/gulpfile.js#L128"><code>deploy</code> task</a>, so I can abandon the sketchy and genuinely terrible deploy process that I used before. (For those curious: <code>gulp build &amp;&amp; git checkout master &amp;&amp; mv dist/*.html . &amp;&amp; git commit -m &quot;Some bad commit message&quot; &amp;&amp; git push &amp;&amp; git checkout src</code> - not shown here are the several attempts where I made some typo or possibly didn&#39;t think of some files in <code>dist/</code> that changed and so should have been <code>mv</code>&#39;d, but weren&#39;t.) And, I now use root-relative includes now, e.g. <code>/js/main.js</code> instead of <code>js/main.js</code>, which is another win for DRY because now I don&#39;t have to maintain different header contents for subpages (which used to be the exact same, just with <code>../</code> prepended to all paths).</p>
<p>In conclusion: yay for progress! And yay for the fact that my codebase actually looks like someone competent wrote it! \o/</p>
<p>(Final note: I haven&#39;t forgotten my promise to blog about stuff happening in pump.io-land. But, not now.)</p>
</div></article></div><footer><p>You may find the source code for this website, licensed to you under the GNU Affero GPL, <a href="https://github.com/strugee/strugee.github.com">on GitHub</a>.</p><p>&copy; Copyright 2012-2016 Alex Jordan.</p></footer><!-- Piwik--><!-- Note that this Piwik instance is self-hosted and so doesn't leak metadata. Also, critically, it respects Do Not Track.--><script type="text/javascript">var _paq = _paq || [];
_paq.push(['trackPageView']);
_paq.push(['enableLinkTracking']);
(function() {
var u="//piwik.strugee.net/";
_paq.push(['setTrackerUrl', u+'piwik.php']);
_paq.push(['setSiteId', 1]);
var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
})();</script><noscript><p><img src="//piwik.strugee.net/piwik.php?idsite=1" style="border:0;" alt=""></p></noscript><!-- End Piwik Code--><div id="toys"><a id="lightbulb-icon" href="#"><div class="icon-lightbulb"></div></a></div><script type="text/javascript" src="/js/main.js"></script><script type="text/javascript" src="/js/idl.js"></script></div></body></html>